This branch is a complete rewrite of the original program in python